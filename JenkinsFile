pipeline {
    agent { label 'windows' }

    tools {
        gradle 'Gradle_7.2'  // Имя инструмента Gradle, как настроено в Jenkins
    }

    stages {
        stage('Build') {
            steps {
                echo 'Starting the Build stage...'
                bat 'echo %PATH%'  // Вывод переменной окружения PATH для отладки
                bat 'dir C:\\ProgramData\\Jenkins\\.jenkins\\tools\\hudson.plugins.gradle.GradleInstallation\\Gradle_7.2\\bin'  // Проверка наличия файлов Gradle
                bat 'C:\\ProgramData\\Jenkins\\.jenkins\\tools\\hudson.plugins.gradle.GradleInstallation\\Gradle_7.2\\bin\\gradle --version'  // Проверка версии Gradle с полным путем
                // Выполнение команды сборки с полным путем и отладочными параметрами
                bat 'C:\\ProgramData\\Jenkins\\.jenkins\\tools\\hudson.plugins.gradle.GradleInstallation\\Gradle_7.2\\bin\\gradle clean build --info'
            }
        }
    }

    post {
        always {
            echo 'Pipeline finished.'
        }
        success {
            echo 'Pipeline completed successfully.'
        }
        failure {
            echo 'Pipeline failed.'
        }
    }
}
